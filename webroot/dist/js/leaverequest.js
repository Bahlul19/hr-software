function demoFromHTML(){var e=new Date,a=e.getDate().toString()+(e.getMonth()+1).toString()+e.getFullYear().toString()+e.getHours().toString()+e.getMinutes().toString()+e.getSeconds().toString(),t=new jsPDF("l","pt","letter");source=$("div#leave-request-list")[0],specialElementHandlers={"#bypassme":function(e,a){return!0}},margins={top:80,bottom:60,left:10,width:1e3},t.fromHTML(source,margins.left,margins.top,{width:margins.width,elementHandlers:specialElementHandlers},function(e){t.save(a+".pdf")},margins)}function demoFromHTMLPdfDownload(){var e=new Date,a=e.getDate().toString()+(e.getMonth()+1).toString()+e.getFullYear().toString()+e.getHours().toString()+e.getMinutes().toString()+e.getSeconds().toString(),t=new jsPDF("l","pt","letter");source=$("div#leave-request-list-for-pdf-downloading")[0],specialElementHandlers={"#bypassme":function(e,a){return!0}},margins={top:80,bottom:60,left:10,width:1e3},t.fromHTML(source,margins.left,margins.top,{width:margins.width,elementHandlers:specialElementHandlers},function(e){t.save(a+".pdf")},margins)}function getBranchwiseLeaveType(){$.ajax({type:"POST",url:"/emp-leaves/getBranchwiseLeaveType",data:{officeLocation:$("#branch-location-request-dropdown").val()},cache:!1,beforeSend:function(){$("div#office-locationwise-leave-type").html('<img src="/img/spinner.gif" style="height: 32px; width: 32px; text-align: center;" alt="Loading.." title="Leaves Taken" />')},success:function(e){$("div#office-locationwise-leave-type").html(e)}})}$(document).ready(function(){function e(e,a,t,l,n,o,r,i,s){3==e&&("SYL"!=a&&"DHK"!=a&&"NYC"!=a||0==t&&0==l&&0==n||(alert("You are not applicable for LWOP leave since you already have Sick/Casual/Earned Leave remaining!"),$("#leaveType").val("")),"GOA"==a&&(0==o&&0==r&&0==i||(alert("You are not applicable for LWOP leave since you already have Planned/Un-Planned/Restricted Leave remaining!"),$("#leaveType").val(""))),"UKR"==a&&0!=s&&(alert("You are not applicable for LWOP leave since you already have Day-off remaining!"),$("#leaveType").val("")))}function a(){if(""==$("#dateFrom").val())return void $("#halfDay option").eq(0).prop("selected",!0);if(""==$("#dateTo").val())return void $("#halfDay option").eq(0).prop("selected",!0);var e=Date.parse($("#dateFrom").val()),a=(Math.round(e/864e5),Date.parse($("#dateTo").val())),t=(Math.round(a/864e5),l($("#dateFrom").val(),$("#dateTo").val()));$("#noOfDays").val(t)}function t(){if(""==$("#dateFrom").val())return void $("#halfDay option").eq(0).prop("selected",!0);if(""==$("#dateTo").val())return void $("#halfDay option").eq(0).prop("selected",!0);var e=Date.parse($("#dateFrom").val()),a=(Math.round(e/864e5),Date.parse($("#dateTo").val())),t=(Math.round(a/864e5),l($("#dateFrom").val(),$("#dateTo").val()));$("#noOfDays").val(t)}function l(e,a){for(var t=0,l=new Date(e),n=new Date(a);l<=n;){var o=l.getDay();6!=o&&0!=o&&t++,l.setDate(l.getDate()+1)}return t}function n(){var e=$("#leaveType").val(),a=$("#lwopTaken").val(),t=$("#noOfDays").val();$("#halfDay").val();3==e&&parseFloat(a)+parseFloat(t)>20&&(alert("You are not applicable to take more then 20 LWoP Leaves."),$("#noOfDays").val(0),$("#dateTo").val(""),$("#reliever").val(""))}function o(e){var a=e;$.ajax({method:"get",url:"<?php echo $this->Url->build( ['controller' => 'EmpLeaves','action' => 'index' ] ); ?>",data:{keyword:a},succcess:function(e){$("div#leave-request").html(e)}})}$(".emp-list-leave-report").select2(),$(".mydatepicker, #datepicker").on("changeDate",function(e){$(this).datepicker("hide"),$("#halfDay option").eq(0).prop("selected",!0)}),$("#dateTo").change(function(){a()}),$("#dateFrom").change(function(){a()}),$("#dateTo").change(function(){a(),t();var e=$("#noOfDays").val();""!=e&&e<=0?($("#dateTo").val(""),$("#noOfDays").val(0)):$("#noOfDays").val(e)}),$("#dateFrom").change(function(){a(),t();var e=$("#noOfDays").val();""!=e&&e<=0?($("#dateTo").val(""),$("#noOfDays").val(0)):$("#noOfDays").val(e)}),$("#dateTo").change(function(){var e=$("#leaveType").val(),a=$("#noOfDays").val();if(1==e){var t=$("#sickRemaining").val(),l=$("#sickTaken").val();parseFloat(a)+parseFloat(l),parseFloat(a)>parseFloat(t)&&($("#noOfDays").val(0),$("#dateFrom").val(""),$("#dateTo").val(""),$("#myRemainingModal").modal({show:!0}))}else if(2==e){var n=$("#casualRemaining").val(),o=$("#casualTaken").val();parseFloat(a)+parseFloat(o),parseFloat(a)>parseFloat(n)&&($("#noOfDays").val(0),$("#dateFrom").val(""),$("#dateTo").val(""),$("#myRemainingModal").modal({show:!0}))}else if(4==e){var r=$("#earnedRemaining").val(),i=$("#earnedTaken").val();parseFloat(a)+parseFloat(i),parseFloat(a)>parseFloat(r)&&($("#noOfDays").val(0),$("#dateFrom").val(""),$("#dateTo").val(""),$("#myRemainingModal").modal({show:!0}))}else if(5==e){var s=$("#unplannedRemaining").val(),v=$("#unplannedTaken").val();parseFloat(a)+parseFloat(v),parseFloat(a)>parseFloat(s)&&($("#noOfDays").val(0),$("#dateFrom").val(""),$("#dateTo").val(""),$("#myRemainingModal").modal({show:!0}))}else if(6==e){var c=$("#plannedRemaining").val(),d=$("#plannedTaken").val();parseFloat(a)+parseFloat(d),parseFloat(a)>parseFloat(c)&&($("#noOfDays").val(0),$("#dateFrom").val(""),$("#dateTo").val(""),$("#myRemainingModal").modal({show:!0}))}else if(7==e){var p=$("#restrictedRemaining").val(),f=$("#restrictedTaken").val();parseFloat(a)+parseFloat(f),parseFloat(a)>parseFloat(p)&&($("#noOfDays").val(0),$("#dateFrom").val(""),$("#dateTo").val(""),$("#myRemainingModal").modal({show:!0}))}else if(8==e){var m=$("#dayOffRemaining").val(),g=$("#dayOffTaken").val();parseFloat(a)+parseFloat(g),parseFloat(a)>parseFloat(m)&&($("#noOfDays").val(0),$("#dateFrom").val(""),$("#dateTo").val(""),$("#myRemainingModal").modal({show:!0}))}}),$("#sick-leave").change(function(){$("#sick-leave").val()>30&&($("#sick-leave").val(0),alert("Sick leave cannot be greater then 7days"))}),$("#casual-leave").change(function(){$("#casual-leave").val()>30&&($("#casual-leave").val(0),alert("Casual leave cannot be greater then 12days(inclusive carry)"))}),$("#unplanned-leave").change(function(){$("#unplanned-leave").val()>27&&($("#unplanned-leave").val(0),alert("Unplanned leave cannot be greater then 7days"))}),$("#planned-leave").change(function(){$("#planned-leave").val()>23&&($("#planned-leave").val(0),alert("Planned leave cannot be greater then 23days(inclusive carry)"))}),$("#restricted-leave").change(function(){$("#restricted-leave").val()>3&&($("#restricted-leave").val(0),alert("Restricted leave cannot be greater then 3days"))}),$("#day-off").change(function(){$("#day-off").val()>18&&($("#day-off").val(0),alert("Day Off leave cannot be greater then 18days"))}),$("#halfDay").change(function(){a();var e=$("#noOfDays").val(),t=$(this).val();"0"!=t?$("#noOfDays").val(.5*e):0==t&&(e=$("#noOfDays").val(),$("#noOfDays").val(e))}),$("select#employee-id").change(function(){var e=$(this).val();console.log(e),""!=e?$.ajax({type:"POST",url:"/emp-leaves/officeLocation",data:{empId:e},cache:!1,beforeSend:function(){$("div#leave_type").html('<img src="/img/spinner.gif" style="height: 32px; width: 32px; text-align: center;" alt="Loading.." title="Employee Office Location" />')},success:function(e){"Error"==e?window.location.href="/employees/dashboard":$("div#leave_type").html(e)}}):""==e&&$.ajax({type:"POST",url:"/emp-leaves/officeLocation",data:{empId:e},cache:!1,beforeSend:function(){$("div#leave_type").html('<img src="/img/spinner.gif" style="height: 32px; width: 32px; text-align: center;" alt="Loading.." title="Employee Office Location" />')},success:function(e){window.location.href="/employees/dashboard"}})}),$("select#employee-id").change(function(){var e=$(this).val();if(""==e)return!1;$.ajax({type:"POST",url:"/emp-leaves/reliever",data:{empId:e},cache:!1,beforeSend:function(){$("div#reliever").html('<img src="/img/spinner.gif" style="height: 32px; width: 32px; text-align: center;" alt="Loading.." title="Employee Office Location" />')},success:function(e){$("div#reliever").html(e)}})}),$("select#employee-id").change(function(){var e=$("select#employee-id").val();if(""==e)return!1;$.ajax({type:"POST",url:"/emp-leaves/leaveTaken",data:{empId:e},cache:!1,beforeSend:function(){$("div#leave_taken").html('<img src="/img/spinner.gif" style="height: 32px; width: 32px; text-align: center;" alt="Loading.." title="Leaves Taken" />')},success:function(e){$("div#leave_taken").html(e)}})}),$(document).on("change","#leaveType",function(a){e($("#leaveType").val(),$("#officeLocation").val(),$("#sickRemaining").val(),$("#casualRemaining").val(),$("#earnedRemaining").val(),$("#plannedRemaining").val(),$("#unplannedRemaining").val(),$("#restrictedRemaining").val(),$("#dayOffRemaining").val())}),$("document").on("change","#reliever",function(e){n()}),$("select#emp-list-leave-report").change(function(){var e=$(this).val();if(""==e)return!1;$.ajax({type:"POST",url:"/emp-leaves/getLeaveType",data:{empId:e},cache:!1,beforeSend:function(){$("div#office-locationwise-leave-type").html('<img src="/img/spinner.gif" style="height: 32px; width: 32px; text-align: center;" alt="Loading.." title="Leaves Taken" />')},success:function(e){$("div#office-locationwise-leave-type").html(e)}})}),$("button#btn-leave-report-search").click(function(){var e=$("#dateTo").val(),a=$("#dateFrom").val(),t=$("select#emp-list-leave-report").val(),l=$("select#leaveType").val();if(""==e||""==a||""==t)return alert("Please select a date, or Employee or Leave Type"),!1;$.ajax({type:"GET",url:"/emp-leaves/getFilteredLeaves",data:{dateFrom:a,dateTo:e,empId:t,leaveType:l},cache:!1,beforeSend:function(){$("div#leave-request-list").html('<img src="/img/spinner.gif" style="height: 32px; width: 32px; text-align: center;" alt="Loading.." title="Leaves Taken" />')},success:function(e){$("div#leave-request-list").html(e)}})}),$(document).on("click","#pagination_leave_report a",function(e){e.preventDefault();var a=$(this);console.log(a),$.ajax({url:a.attr("href"),beforeSend:function(){$("div#leave-request-list").html('<img src="/img/spinner.gif" style="height: 32px; width: 32px; text-align: center;" alt="Loading.." title="Leaves Taken" />')}}).done(function(e){var a;a=$(e),$("div#leave-request-list").html(a)}).fail(function(){window.location.href=a.attr("href")})}),$("button#btn-branch-leave-report-search").click(function(){var e=$("#dateTo").val(),a=$("#dateFrom").val(),t=$("select#branch-location-request-dropdown").val(),l=$("select#leaveType").val();if(""==e||""==a||""==t)return alert("Please select a date, or office location or Leave Type"),!1;$.ajax({type:"GET",url:"/emp-leaves/getBranchwiseFilteredLeaves",data:{dateFrom:a,dateTo:e,branch:t,leaveType:l},cache:!1,beforeSend:function(){$("div#leave-request-list").html('<img src="/img/spinner.gif" style="height: 32px; width: 32px; text-align: center;" alt="Loading.." title="Leaves Taken" />')},success:function(e){$("div#leave-request-list").html(e)}})}),$(document).on("click","#pagination_branch_wise_leave_report a",function(e){e.preventDefault();var a=$(this);console.log(a),$.ajax({url:a.attr("href"),beforeSend:function(){$("div#leave-request-list").html('<img src="/img/spinner.gif" style="height: 32px; width: 32px; text-align: center;" alt="Loading.." title="Leaves Taken" />')}}).done(function(e){var a;a=$(e),$("div#leave-request-list").html(a)}).fail(function(){window.location.href=a.attr("href")})}),$("button#btn-leave-report-export").click(function(){var e=$("#employee-report-type").val();if(""==e)return alert("Please select a Report Type"),!1;var a=$("#dateTo").val(),t=$("#dateFrom").val(),l=$("select#emp-list-leave-report").val(),n=$("select#leaveType").val(),o=$("select#emp-list-leave-report").val();if(""==a||""==t||""==l)return alert("Please select a date, or Employee or Leave Type"),!1;if(3==e){if(a=$("#dateTo").val(),t=$("#dateFrom").val(),o=$("select#emp-list-leave-report").val(),n=$("select#leaveType").val(),""==a||""==t||""==o)return alert("Please select a date, or Employee or Leave Type"),!1;$.ajax({type:"GET",url:"/emp-leaves/getFilteredLeavesForPdf",data:{dateFrom:t,dateTo:a,empId:o,leaveType:n},cache:!1,beforeSend:function(){$("div#leave-request-list-for-pdf-downloading").html('<img src="/img/spinner.gif" style="height: 32px; width: 32px; text-align: center;" alt="Loading.." title="Leaves Taken" />')},success:function(e){$("div#leave-request-list-for-pdf-downloading").html(e),demoFromHTMLPdfDownload()}})}else{var r="";if(1==e?r="xls":2==e&&(r="csv"),a=$("#dateTo").val(),t=$("#dateFrom").val(),o=$("select#emp-list-leave-report").val(),n=$("select#leaveType").val(),""==a||""==t||""==o)return alert("Please select a date, or Employee or Leave Type"),!1;if(""==n){var i="/emp-leaves/downloadLeaveReport/"+t.replace(/\//g,"-")+"/"+a.replace(/\//g,"-")+"/"+o+"/all/"+r;window.location.href=i}else{var s="/emp-leaves/downloadLeaveReport/"+t.replace(/\//g,"-")+"/"+a.replace(/\//g,"-")+"/"+o+"/"+n+"/"+r;window.location.href=s}}}),$("button#btn-branch-leave-report-export").click(function(){var e=$("#employee-report-type").val();if(""==e)return alert("Please select a Report Type"),!1;var a=$("#dateTo").val(),t=$("#dateFrom").val(),l=$("select#branch-location-request-dropdown").val();if(""==a||""==t||""==l)return alert("Please select a date and branch"),!1;if(3==e){a=$("#dateTo").val(),t=$("#dateFrom").val();var n=$("select#branch-location-request-dropdown").val(),o=$("select#leaveType").val();if(""==a||""==t||""==n)return alert("Please select a date, or Employee or Leave Type"),!1;$.ajax({type:"GET",url:"/emp-leaves/getBranchFilteredLeavesForPdf",data:{dateFrom:t,dateTo:a,branch:n,leaveType:o},cache:!1,beforeSend:function(){$("div#leave-request-list-for-pdf-downloading").html('<img src="/img/spinner.gif" style="height: 32px; width: 32px; text-align: center;" alt="Loading.." title="Leaves Taken" />')},success:function(e){$("div#leave-request-list-for-pdf-downloading").html(""),demoFromHTMLPdfDownload()}})}else{var r="";1==e?r="xls":2==e&&(r="csv"),a=$("#dateTo").val(),t=$("#dateFrom").val();var i=$("select#branch-location-request-dropdown").val(),s=$("select#leaveType").val();if(""==a||""==t||""==i)return alert("Please select a date, or Employee or Leave Type"),!1;if(""==s){var v="/emp-leaves/downloadBranchwiseLeaveReport/"+t.replace(/\//g,"-")+"/"+a.replace(/\//g,"-")+"/"+i+"/all/"+r;window.location.href=v}else{var c="/emp-leaves/downloadBranchwiseLeaveReport/"+t.replace(/\//g,"-")+"/"+a.replace(/\//g,"-")+"/"+i+"/"+s+"/"+r;window.location.href=c}}}),$("#search").keyup(function(){var e=$(this).val();console.log(e),o(e)})});